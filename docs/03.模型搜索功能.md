# 模型搜索功能

## 功能概述

模型搜索功能允许用户根据不同的条件搜索模型，包括按名称、模型家族和标签搜索。该功能提供了模型市场的能力，帮助用户发现和下载新的模型。

## 功能详情

### 1. 搜索方式

#### 按名称搜索
- 用户可以输入模型名称关键词进行搜索
- 支持模糊匹配和正则表达式匹配

#### 按家族搜索
- 用户可以选择一个或多个模型家族进行筛选
- 常见的模型家族包括：llama3、mistral、mixtral、gemma、phi3 等

#### 按标签搜索
- 用户可以选择一个或多个标签进行筛选
- 常见的标签包括：embedding、vision、tools、thinking、8b、70b、7b、3.8b 等

### 2. 搜索结果展示

- 搜索结果按模型家族分组展示
- 每个模型显示名称和大小信息
- 提供下载按钮用于下载选中的模型

### 3. 模型下载

- 用户可以从搜索结果中选择模型进行下载
- 下载操作针对当前选中的服务器执行
- 下载完成后会自动刷新模型列表

## 界面设计

### 主要组件

1. **搜索抽屉**：
   - 点击"搜索模型"按钮打开
   - 包含搜索输入框和搜索按钮
   - 显示搜索结果列表

2. **搜索输入框**：
   - 支持输入模型名称关键词
   - 支持回车键快速搜索

3. **模型家族和标签筛选**：
   - 提供复选框选择模型家族和标签
   - 支持多选

4. **搜索结果列表**：
   - 按模型家族分组展示
   - 每个模型提供下载按钮

## API 接口

### 后端接口

1. `SearchModels(params map[string]interface{}) ([]Model, error)`：
   - 根据搜索参数搜索模型
   - 支持 query、families、tags 参数

2. `GetModelFamilies() []string`：
   - 获取所有模型家族列表

3. `GetModelTags() []string`：
   - 获取所有模型标签列表

## 搜索逻辑

### 搜索参数处理

- 支持组合多个搜索条件
- 如果没有搜索条件，返回所有模型
- 搜索条件之间是 AND 关系

### 模型匹配规则

1. **名称匹配**：
   - 支持正则表达式匹配
   - 支持普通字符串包含匹配
   - 忽略大小写

2. **家族匹配**：
   - 模型名称冒号前的部分为家族名称
   - 完全匹配（忽略大小写）

3. **标签匹配**：
   - 模型名称中包含标签关键词
   - 完全匹配（忽略大小写）

## 数据结构

### 搜索参数结构

```go
type ModelSearchParams struct {
    Query    string   // 搜索关键词
    Families []string // 模型家族列表
    Tags     []string // 标签列表
}
```

### 模型结构

```go
type Model struct {
    Name       string                 // 模型名称
    Model      string                 // 模型标识
    ModifiedAt string                 // 修改时间
    Size       int64                  // 模型大小
    Digest     string                 // 摘要信息
    Details    map[string]interface{} // 详细信息
}
```

## 搜索优化

### 性能优化

- 搜索结果按名称排序
- 搜索过程不阻塞界面主线程
- 提供加载状态指示

### 用户体验优化

- 提供搜索提示信息
- 搜索结果为空时显示友好提示
- 支持键盘快捷键操作（回车搜索）