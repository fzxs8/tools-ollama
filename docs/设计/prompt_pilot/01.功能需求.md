# PromptPilot功能需求

## 模块概述

PromptPilot是一个专门用于提示词工程的模块，帮助用户创建、优化和管理提示词。该模块提供直观的界面让用户能够快速生成初始提示词，对其进行调优，并支持多模型对比测试，以找到最佳的提示词配置。

## 核心功能

### 1. 提示词生成
- **想法输入**: 用户可以输入一个想法或需求描述
- **服务选择**: 用户可选择已配置的Ollama服务
- **模型选择**: 用户可选择已配置服务中的模型
- **生成Prompt**: 点击「生成Prompt」按钮，系统将基于用户想法和选定模型流式生成初始Prompt
- **流式展示**: 生成过程中实时展示Prompt内容，提供类似打字机的效果。后端通过Wails事件（如`prompt_pilot_stream`）将数据流式发送到前端。

### 2. 提示词调优
- **快速优化**: 用户可以对当前生成的Prompt进行快速优化
- **反馈机制**: 用户提供优化反馈，系统基于反馈进一步优化Prompt
- **迭代优化**: 支持多次优化迭代，逐步完善Prompt质量

### 3. 提示词管理
- **保存功能**: 用户可以保存调整好的提示词，并为其命名
- **历史管理**: 提供右侧抽屉展示所有已保存的提示词工程
- **操作功能**: 
  - 测试预览：可以预览提示词效果
  - 保存编辑：可以编辑和保存提示词
  - 删除：可以删除不需要的提示词
- **标签管理**: 支持为Prompt添加标签，便于分类和检索

### 4. 多模型对比测试
- **并行测试**: 在提示时可同时操作3个模型进行对比测试
- **效果对比**: 直观展示不同模型生成的Prompt效果
- **选择最佳**: 用户可以选择效果最佳的Prompt进行保存

## 用户交互流程

### 4.1 Prompt生成流程
1. 用户在输入框中输入想法或需求
2. 用户从已配置的Ollama服务列表中选择一个服务
3. 系统加载该服务中可用的模型列表
4. 用户从该服务的模型列表中选择一个或多个模型（最多3个）
5. 当用户尝试选择第4个模型时，系统会显示明确提示，告知最多只能选择3个模型
6. 用户点击「生成Prompt」按钮
7. 系统基于用户想法和选定模型流式生成初始Prompt
8. 用户可以实时看到Prompt生成过程

### 4.2 Prompt调优流程
1. 用户对生成的Prompt进行查看
2. 用户点击「优化」按钮
3. 用户提供优化反馈或建议
4. 系统基于反馈进一步优化Prompt
5. 用户可重复优化过程直到满意

### 4.3 Prompt管理流程
1. 用户完成Prompt生成和调优
2. 用户点击「保存」按钮
3. 用户为Prompt命名并添加描述（可选）
4. 用户可以为Prompt添加标签
5. Prompt保存到用户个人库中
6. 用户可随时点击「已保存」按钮查看所有保存的Prompt

### 4.4 多模型对比测试流程
1. 用户在生成或测试Prompt时选择多个模型（最多3个）
2. 系统并行调用多个模型生成Prompt
3. 界面分栏展示各模型生成结果
4. 用户对比不同模型的输出效果
5. 用户选择最佳结果进行保存或进一步优化

## 功能详细说明

### 5.1 用户界面设计
- **主输入区**: 提供大文本框供用户输入想法
- **服务选择区**: 展示可选的已配置Ollama服务列表
- **模型选择区**: 展示选中服务下的可选模型列表，支持多选（最多3个）
- **生成按钮**: 「生成Prompt」按钮触发Prompt生成
- **Prompt展示区**: 流式展示生成的Prompt内容
- **操作按钮区**: 包含「优化」、「保存」和「已保存」按钮
- **抽屉面板**: 右侧滑出抽屉包含优化表单、保存表单和已保存Prompt列表

### 5.2 数据结构设计
- **Prompt对象**:
  - ID: 唯一标识符
  - Name: 用户命名
  - Content: Prompt内容
  - Description: 描述信息（可选）
  - CreatedAt: 创建时间
  - UpdatedAt: 更新时间
  - Models: 使用的模型列表
  - Version: 版本号（支持迭代优化）
  - Tags: 标签列表（支持分类管理）
  - ServerId: 使用的服务ID

### 5.3 存储设计
- **本地存储**: 使用duolasdk存储功能保存用户Prompt库
- **键名设计**: 
  - "prompts": 存储所有Prompt列表
  - "prompt_{id}": 存储单个Prompt详情
- **持久化**: 所有Prompt数据持久化存储，确保不会丢失

### 5.4 API接口设计
- **GeneratePrompt**: 根据想法生成Prompt
- **OptimizePrompt**: 优化现有Prompt
- **ListPrompts**: 获取Prompt列表
- **GetPrompt**: 获取单个Prompt详情
- **SavePrompt**: 保存Prompt
- **DeletePrompt**: 删除Prompt
- **TestPrompt**: 测试Prompt效果（多模型对比）
- **GetServers**: 获取已配置的服务列表
- **GetModelsByServer**: 根据服务ID获取模型列表

## 技术实现要求

### 6.1 前端技术要求
- 使用Vue3 + TypeScript开发
- 采用Element Plus组件库
- 实现流式内容展示效果
- 支持响应式布局设计

### 6.2 后端技术要求
- 基于Go语言实现
- 集成Wails框架与前端通信
- 调用Ollama API生成和优化Prompt
- 实现多模型并行处理能力

### 6.3 性能要求
- Prompt生成响应时间不超过3秒
- 多模型并行处理时各模型互不影响
- 界面操作流畅，无明显卡顿

### 6.4 安全要求
- 用户Prompt数据隔离存储
- 敏感信息不记录日志
- 防止恶意输入攻击

### 6.5 用户体验要求
- 当用户尝试选择超过3个模型时，应显示明确的提示信息
- 禁用超过限制的模型选项
- 提供友好的交互反馈
- 服务和模型选择应有明确的层级关系
- 所有操作按钮应清晰可见且易于理解