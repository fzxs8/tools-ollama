# 2. 界面设计

本页面旨在提供一个风格统一、交互友好的 OpenAI 适配器管理界面。整体视觉风格应参考 Ollama 官方应用的简洁、现代风格，以深色模式为基础，提供清晰的信息展示和流畅的操作体验。

## 2.1. 页面布局

页面主体由一个居中的卡片构成，卡片内从上到下依次为：
1.  **服务控制区**：包含核心的启停操作和状态显示。
2.  **网络配置区**：配置服务的监听地址和端口。
3.  **目标服务区**：选择要连接的后端 Ollama 服务。
4.  **操作区**：放置“保存”、“查看 API”和“查看日志”等功能按钮。

## 2.2. 控件详解

### 2.2.1. 服务控制区

- **启停切换按钮**: 
    - **控件**: 单个切换按钮 (Toggle Button)，集成状态显示。
    - **状态与外观**:
        - **停止时**: 背景色为灰色或蓝色，文本为 `启动服务`。
        - **运行时**: 背景色为绿色，文本为 `服务运行中`。
        - **加载中**: 按钮显示加载动画，文本为 `启动中...` 或 `停止中...`，并禁用点击。
    - **交互**: 实现防抖（debounce）机制，防止用户在状态切换期间的快速重复点击。

- **状态指示**: 
    - **控件**: 按钮左侧的一个小圆形指示灯 (Badge)。
    - **颜色**: 
        - **灰色**: 已停止
        - **绿色**: 运行中
        - **红色**: 启动失败 (按钮旁应显示简短错误信息)

### 2.2.2. 网络配置区

- **监听 IP 地址**: 
    - **控件**: 输入框 (Input)。
    - **标签**: `监听地址`。
    - **默认值**: `127.0.0.1`。
    - **禁用逻辑**: 当服务正在运行时，此输入框应被禁用。

- **监听端口**: 
    - **控件**: 数字输入框 (InputNumber)。
    - **标签**: `监听端口`。
    - **默认值**: `11223`。
    - **禁用逻辑**: 当服务正在运行时，此输入框应被禁用。

### 2.2.3. 目标服务区

- **Ollama 服务选择**: 
    - **控件**: 下拉选择框 (Select)。
    - **标签**: `目标 Ollama 服务`。
    - **选项**: 动态加载所有已配置的 Ollama 服务列表。
    - **禁用逻辑**: 当服务正在运行时，此下拉框应被禁用。

### 2.2.4. 操作区

- **保存设置按钮**: 
    - **文本**: `保存设置`。
    - **禁用逻辑**: 当服务正在运行时，此按钮应被禁用。

- **查看 API 按钮**: 
    - **文本**: `查看 API`。
    - **交互**: 点击后，从页面右侧滑出“API 文档”抽屉。

- **查看日志按钮**: 
    - **文本**: `查看日志`。
    - **交互**: 点击后，从页面右侧滑出“实时日志”抽屉。

## 2.3. 抽屉面板设计

### 2.3.1. 实时日志抽屉

- **标题**: `适配器实时日志`。
- **内容区**: 
    - 一个代码显示区域，用于实时、逐行、自动滚动显示后端推送的日志。
    - 日志列表在前端应使用**虚拟滚动**或**环形缓冲区**（Circular Buffer）实现，仅保留最新的 N 条记录（如 500 条），防止 DOM 元素过多导致页面卡顿。
- **操作区** (位于抽屉顶部):
    - **清空日志按钮**: 点击后清除前端显示的所有日志记录。
    - **下载日志按钮**: 点击后将当前前端持有的所有日志记录导出为 `openai_adapter.log` 文件下载。

### 2.3.2. API 文档抽屉

- **标题**: `API 调用示例`。
- **内容区**: 
    - 使用格式化代码块，清晰展示 API 的调用方式。
    - **必须**提供基于 `curl` 的完整调用示例。

#### `curl` 示例：非流式请求

```sh
curl http://<IP>:<Port>/v1/chat/completions -X POST \
-H "Content-Type: application/json" \
-d '{
  "model": "llama3",
  "messages": [
    {
      "role": "user",
      "content": "你好，介绍一下你自己"
    }
  ],
  "stream": false
}'
```

#### `curl` 示例：流式请求

```sh
curl http://<IP>:<Port>/v1/chat/completions -X POST \
-H "Content-Type: application/json" \
-d '{
  "model": "llama3",
  "messages": [
    {
      "role": "user",
      "content": "给我讲一个关于程序员的笑话"
    }
  ],
  "stream": true
}'
```

> **注意**: 示例中的 `<IP>` 和 `<Port>` 应动态替换为用户当前在配置区设置的值，以方便用户直接复制使用。
