# Ollama API 调试器模块 - 界面设计

## 1. Architecture（架构设计）

### 1.1 设计原则
- **类 Postman 风格**: 采用经典的两栏布局，降低学习成本
- **功能优先**: 突出核心调试功能，减少界面干扰
- **响应式设计**: 适配不同屏幕尺寸的桌面应用
- **视觉一致性**: 与整体应用的设计语言保持一致

### 1.2 布局架构
```
主界面布局
├── 左侧边栏 (Sidebar)
│   ├── 服务选择器 (Server Selector)
│   └── API列表 (API List)
└── 右侧主内容区 (Main Content)
    ├── 请求构建区 (Request Panel)
    └── 响应显示区 (Response Panel)
```

### 1.3 色彩系统
- **主色调**: #007bff (Bootstrap Primary)
- **成功色**: #28a745 (HTTP 2xx)
- **警告色**: #ffc107 (HTTP 3xx)
- **危险色**: #dc3545 (HTTP 4xx/5xx)
- **信息色**: #6c757d (Secondary)

## 2. Analysis（需求分析）

### 2.1 界面功能分析
| 功能区域 | 核心功能 | 交互方式 | 优先级 |
|---------|----------|----------|--------|
| 服务选择器 | 服务器选择 | 下拉选择 | P0 |
| API列表 | API模板选择 | 点击选择 | P0 |
| 请求构建区 | 参数编辑 | 表单编辑 | P0 |
| 响应显示区 | 结果展示 | 标签切换 | P0 |

### 2.2 用户交互分析
#### 主要交互路径
1. **快速测试**: 选择API → 点击发送 → 查看结果
2. **参数调试**: 选择API → 修改参数 → 发送测试 → 分析结果
3. **错误排查**: 发送请求 → 查看错误信息 → 调整参数 → 重新测试

### 2.3 响应式断点
- **大屏**: ≥1200px (桌面端)
- **中屏**: 768px-1199px (小桌面端)
- **小屏**: <768px (平板端)

## 3. Architecture（界面架构）

### 3.1 整体布局设计

#### 3.1.1 布局结构
采用类似 Postman 的经典两栏布局，以提供更直观、高效的 API 调试体验。

*   **左侧边栏**: 用于选择服务和 API 接口。
*   **右侧主内容区**: 上下结构，上方为请求构建区，下方为响应显示区。

#### 3.1.2 CSS Grid 布局
```css
.api-debugger-container {
  display: flex;
  height: 100vh;
  background-color: #f0f2f5;
}

.sidebar {
  width: 280px;
  flex-shrink: 0;
  background-color: #fff;
  border-right: 1px solid #e0e0e0;
}

.main-content {
  flex-grow: 1;
  display: flex;
  flex-direction: column;
  overflow: hidden;
}
```

### 3.2 左侧边栏 (Sidebar)
#### 3.2.1 服务选择器
*   位于侧边栏最上方。
*   一个下拉列表 (`<select>`)，用于展示和选择在 `OllamaSettings` 中配置的所有 Ollama 服务。
*   选择的服务将为右侧的 API 请求提供 `BaseURL`。

#### 3.2.2 API 接口列表
*   位于服务选择器下方。
*   一个可滚动的列表，展示从 `API.md` 解析出的所有可用 Ollama API 接口。
*   每一项都清晰地标出 **HTTP 方法** (如 GET, POST) 和 **API 名称** (如 “列出本地模型”)。
*   点击列表中的任意一项，会自动在右侧的请求构建区填充该 API 的预设参数。
*   当前选中的 API 项会有高亮背景，以示区分。

### 3.3 右侧主内容区 (Main Content)
#### 3.3.1 请求构建区 (Request Panel)
*   **URL & 方法行**:
    *   **HTTP 方法**: 不再是下拉框，而是根据左侧选择的 API 自动填充，并以带颜色的标签形式展示 (如 绿色 POST, 蓝色 GET)。
    *   **URL 输入框**: 宽大的文本输入框，自动填充所选 API 的路径 (如 `/api/ps`)，用户可以手动修改。
    *   **发送按钮**: 位于最右侧，一个显眼的 “发送” 按钮。
*   **请求参数 Tab 区**: 包含 `查询参数`, `请求头`, `请求体` 三个 Tab。
    *   **查询参数 (Params)**: 表格形式，用于编辑 URL 查询参数。
    *   **请求头 (Headers)**: 表格形式，用于编辑 HTTP 请求头。
    *   **请求体 (Body)**: 提供 `None`, `Raw`, `Form Data` 等多种类型选择，其中 `Raw` 类型支持 JSON, Text, HTML 等子类型，并提供一个 `textarea` 用于编辑内容。

#### 3.3.2 响应显示区 (Response Panel)
*   **布局**: 此区域将自动填满请求区域下方的所有剩余垂直空间。
*   **状态显示**: 在请求发送前，显示提示信息 (如 “点击发送按钮以发起请求”)。在请求过程中，显示 “加载中...”。如果请求出错，则显示错误详情。
*   **成功响应**: 请求成功后，此区域会以上下 Tab 形式展示响应内容。
    *   **状态行**: 位于最上方，清晰显示 HTTP 状态码、状态文本和请求耗时。
    *   **响应内容 Tab 区**: 包含 `响应体` 和 `响应头` 两个 Tab。
        *   **响应体 (Body)**: 默认展示。在一个 `<pre>` 标签中显示响应体内容，并自动进行 JSON 格式化。内容左对齐。
        *   **响应头 (Headers)**: 以只读表格形式展示所有响应头。
*   **滚动条**: 当响应内容超出显示区域的高度时，内容区域会出现垂直滚动条，整个页面高度保持不变。

## 4. Application（应用实现）

### 4.1 样式系统

#### 4.1.1 主题变量
```css
:root {
  --debugger-primary-color: #007bff;
  --debugger-success-color: #28a745;
  --debugger-warning-color: #ffc107;
  --debugger-danger-color: #dc3545;
  --debugger-info-color: #6c757d;
  
  --debugger-bg-color: #ffffff;
  --debugger-bg-light: #f0f2f5;
  --debugger-border-color: #e0e0e0;
  --debugger-text-color: #333333;
  --debugger-text-light: #666666;
  
  --debugger-border-radius: 4px;
  --debugger-box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}
```

#### 4.1.2 HTTP方法样式
```css
.method-badge {
  display: inline-block;
  padding: 0.2em 0.5em;
  border-radius: 3px;
  font-size: 0.75em;
  font-weight: bold;
  color: #fff;
  min-width: 45px;
  text-align: center;
}

.method-badge.get { background-color: #61affe; }
.method-badge.post { background-color: #49cc90; }
.method-badge.put { background-color: #fca130; }
.method-badge.delete { background-color: #f93e3e; }
.method-badge.patch { background-color: #50e3c2; }
.method-badge.head { background-color: #9012fe; }
```

### 4.2 组件实现

#### 4.2.1 API列表组件
```vue
<template>
  <div class="api-list">
    <h3>{{ t('apiDebugger.ollamaApiList') }}</h3>
    <ul>
      <li
        v-for="api in apiDefinitions"
        :key="api.name"
        :class="{ active: activeApiName === api.name }"
        @click="selectApi(api)"
      >
        <span :class="['method-badge', api.method.toLowerCase()]">
          {{ api.method }}
        </span>
        {{ api.name }}
      </li>
    </ul>
  </div>
</template>
```

#### 4.2.2 请求参数编辑器
```vue
<template>
  <div class="key-value-editor">
    <div v-for="(param, index) in request.queryParams" :key="index" class="kv-row">
      <input type="checkbox" v-model="param.enabled" />
      <input type="text" v-model="param.key" :placeholder="t('apiDebugger.key')" />
      <input type="text" v-model="param.value" :placeholder="t('apiDebugger.value')" />
      <button @click="removeQueryParam(index)">{{ t('apiDebugger.remove') }}</button>
    </div>
    <button @click="addQueryParam">{{ t('apiDebugger.addParameter') }}</button>
  </div>
</template>
```

### 4.3 交互动效

#### 4.3.1 加载动画
```css
.loading-spinner {
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  animation: spin 1s linear infinite;
  border: 2px solid #f3f3f3;
  border-top: 2px solid #007bff;
  border-radius: 50%;
  width: 20px;
  height: 20px;
}
```

#### 4.3.2 状态转换
```css
.status-transition {
  transition: all 0.3s ease;
}

.status-success { color: #28a745; }
.status-error { color: #dc3545; }
.status-warning { color: #ffc107; }
```

### 4.4 响应式设计

#### 4.4.1 平板端适配
```css
@media (max-width: 1199px) {
  .sidebar {
    width: 240px;
  }
  
  .api-list li {
    font-size: 0.9rem;
    padding: 0.5rem;
  }
}
```

#### 4.4.2 小屏幕适配
```css
@media (max-width: 768px) {
  .api-debugger-container {
    flex-direction: column;
  }
  
  .sidebar {
    width: 100%;
    height: 200px;
    border-right: none;
    border-bottom: 1px solid #e0e0e0;
  }
}
```

## 5. Assurance（质量保证）

### 5.1 用户体验保证

#### 可用性保证
- **直观操作**: 类 Postman 界面，学习成本低
- **快速上手**: 预设 API 模板，开箱即用
- **实时反馈**: 加载状态和错误提示清晰
- **结果可视**: JSON 自动格式化，易于阅读

#### 交互一致性
- **视觉统一**: 与整体应用设计语言一致
- **操作统一**: 按钮、表单、标签页等组件交互一致
- **反馈统一**: 成功、错误、警告状态显示统一

### 5.2 性能保证

#### 渲染性能
- **虚拟列表**: API 列表支持大量数据显示
- **懒加载**: 非关键组件延迟加载
- **防抖动**: 输入框防抖动处理
- **内存优化**: 及时清理无用的响应数据

#### 加载性能
- **组件分割**: 按需加载组件
- **资源压缩**: CSS/JS 文件压缩
- **缓存策略**: 静态资源缓存

### 5.3 兼容性保证

#### 浏览器兼容
- **现代浏览器**: 支持 Chrome 80+, Firefox 75+, Safari 13+
- **Electron 环境**: 专为 Wails 桌面应用优化
- **跨平台**: Windows, macOS, Linux 全平台支持

#### 屏幕适配
- **多分辨率**: 支持 1920x1080 到 1366x768 分辨率
- **缩放支持**: 支持 75%-150% 缩放比例
- **高DPI**: 支持高DPI屏幕显示

## 6. Action（行动计划）

### 6.1 设计实现计划

#### 阶段1: 基础界面 (1周)
- ✅ 主界面布局框架
- ✅ 左侧边栏设计
- ✅ 请求构建区设计
- ✅ 响应显示区设计

#### 阶段2: 交互优化 (1周)
- ✅ HTTP方法样式设计
- ✅ 加载状态动画
- ✅ 错误状态处理
- ✅ 响应式布局适配

#### 阶段3: 细节打磨 (1周)
- ✅ 视觉统一性优化
- ✅ 交互动效完善
- ✅ 可用性测试
- ✅ 性能优化

### 6.2 设计规范

#### 间距规范
- **基础间距**: 8px, 16px, 24px, 32px
- **组件间距**: 16px (小组件), 24px (中组件), 32px (大组件)
- **布局间距**: 1rem (16px) 标准间距

#### 字体规范
- **正文**: 14px, line-height: 1.5
- **小标题**: 16px, font-weight: 600
- **辅助文字**: 12px, color: #666
- **代码字体**: 'Fira Code', 'Cascadia Code', monospace

#### 圆角规范
- **基础圆角**: 4px (按钮、输入框)
- **卡片圆角**: 8px (卡片、面板)
- **大圆角**: 12px (弹窗、对话框)

### 6.3 组件库扩展

#### 自定义组件
- **ApiMethodBadge**: HTTP方法标签组件
- **KeyValueEditor**: 键值对编辑器组件
- **ResponseViewer**: 响应结果显示组件
- **LoadingSpinner**: 加载动画组件

#### 主题定制
- **深色模式**: 支持深色主题切换
- **主题变量**: CSS 变量系统
- **动态主题**: 运行时主题切换

#### 图标系统
- **统一图标**: 使用 Feather Icons 或 Heroicons
- **图标规范**: 16px, 20px, 24px 三种尺寸
- **图标色彩**: 与文字色彩保持一致
