# Ollama API 调试器模块 - API 接口 (V2)

## 1. 模块内部 Go API (Wails 绑定)

### 1.1. `SendHttpRequest`
*   **功能**: 接收前端构建的 `ApiRequest` 对象，直接使用 Go 标准库 `net/http` 发送一个 HTTP 请求，并返回一个 `ApiResponse` 对象。
*   **方法签名**:
    ```go
    func (a *App) SendHttpRequest(request types.ApiRequest) (types.ApiResponse, error)
    ```
*   **参数**:
    *   `request`: `types.ApiRequest`，包含前端用户构建的所有请求信息。
*   **返回**:
    *   `types.ApiResponse`，包含响应状态码、响应头、响应体、请求耗时和可能的错误信息。
*   **实现细节 (V2)**:
    1.  **获取 Base URL**: 根据 `request.SelectedServerID` 从 `configMgr` 调用 `GetServerByID` 获取对应的 `OllamaServerConfig`，从而得到 Base URL。
    2.  **构建完整 URL**: 使用 `url.JoinPath` 和 `url.Parse` 将 Base URL、API 路径和用户定义的查询参数拼接成最终的请求 URL。
    3.  **准备请求体**: 根据 `request.Body.Type` (raw, formData, none)，使用 `strings.NewReader` 创建一个 `io.Reader` 作为请求体。同时，根据类型确定 `Content-Type`。
    4.  **创建标准请求**: 调用 `http.NewRequestWithContext` 创建一个 `*http.Request` 对象。
    5.  **设置请求头**: 手动遍历 `request.Headers`，并将所有启用的请求头（包括上一步确定的 `Content-Type`）逐一设置到 `req.Header` 中。这是为了保证对请求头的完全控制。
    6.  **发送请求**: 创建一个标准的 `*http.Client`，并调用其 `Do` 方法发送请求。
    7.  **处理响应**: 读取 `*http.Response` 的状态码、响应头和响应体，计算总耗时，并将所有信息组装成 `types.ApiResponse` 返回。

### 1.2. `GetOllamaServers`
*   **功能**: 获取所有已配置的 Ollama 服务列表。
*   **方法签名**:
    ```go
    func (a *App) GetOllamaServers() ([]types.OllamaServerConfig, error)
    ```
*   **实现细节**: 直接调用 `configMgr.GetServers()`。

## 2. 核心依赖 (V2)

*   **`configMgr.GetServerByID(serverID string)`**: 根据 ID 获取单个服务器配置。 (来自 `ollama_config.go`)
*   **Go 标准库 `net/http`**: 用于创建、发送和处理 HTTP 请求/响应。
*   **Go 标准库 `net/url`**: 用于拼接和解析 URL 及查询参数。
*   **Go 标准库 `io`**: 用于读取响应体。
*   **Go 标准库 `strings`**: 用于创建请求体 `io.Reader`。
