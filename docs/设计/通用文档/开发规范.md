# 项目开发规范

## 代码规范

### Vue/TypeScript 规范

#### 组件结构规范
1. 使用 `<script setup lang="ts">` 语法
2. 按照以下顺序组织代码：
   - 导入语句
   - 接口定义
   - 常量定义
   - 响应式数据
   - 计算属性
   - 方法定义
   - 生命周期钩子
   - 监听器

#### 命名规范
1. 组件文件名：PascalCase，如 `ModelManager.vue`
2. 变量名：camelCase，如 `localModels`
3. 常量名：UPPER_SNAKE_CASE，如 `DEFAULT_CONTEXT_SIZE`
4. 方法名：camelCase，动词开头，如 `getModels` / `loadRemoteServers`
5. 计算属性：camelCase，名词形式，如 `modelGroups`

#### 类型定义规范
1. 所有接口使用 TypeScript 定义
2. 复杂类型在文件顶部定义
3. 使用明确的类型而非 any
4. 接口名称使用 PascalCase

#### 响应式数据规范
1. 使用 `ref` 处理基本类型和数组
2. 使用 `reactive` 处理对象类型
3. 合理使用 `computed` 计算属性
4. 避免直接修改 props

### Go 后端规范

#### 结构体标签规范
1. 所有结构体字段必须包含 `json` 标签
2. 标签名与前端字段名保持一致
3. 使用合适的类型标签

#### 错误处理规范
1. 所有函数返回 `error` 类型
2. 错误信息应具体明确
3. 不应忽略错误返回值
4. 使用 fmt.Errorf 包装错误信息

#### 接口设计规范
1. 接口名称清晰表达功能
2. 参数和返回值类型明确
3. 遵循最小权限原则
4. 保持接口一致性

## 界面开发规范

### Element Plus 组件使用规范

#### 表格组件使用
1. 使用 `el-table` 和 `el-table-column` 展示列表数据
2. 合理设置列宽度
3. 使用插槽自定义单元格内容
4. 表头使用明确的中文标签

#### 表单组件使用
1. 使用 `el-form` 和 `el-form-item` 组织表单
2. 合理使用表单验证
3. 提供清晰的占位符和提示信息

#### 抽屉组件使用
1. 使用 `el-drawer` 实现抽屉效果
2. 设置合适的尺寸（推荐40%）
3. 提供明确的标题
4. 使用 `direction="rtl"` 从右侧滑出

#### 消息提示规范
1. 使用 `ElMessage` 显示操作结果
2. 成功消息使用绿色（type: 'success'）
3. 错误消息使用红色（type: 'error'）
4. 警告消息使用黄色（type: 'warning'）
5. 信息提示使用蓝色（type: 'info'）

#### 下拉菜单组件使用
1. 使用 `el-dropdown`、`el-dropdown-menu` 和 `el-dropdown-item` 实现下拉菜单
2. 在操作列空间不足时使用下拉菜单替代多个按钮
3. 使用统一的命令处理函数处理所有下拉菜单命令

### 响应式设计规范

#### 布局规范
1. 使用 `el-row` 和 `el-col` 实现响应式布局
2. 合理设置 gutter 间距
3. 移动端适配考虑

#### 断点规范
1. xs: < 768px
2. sm: 768px - 992px
3. md: 992px - 1200px
4. lg: 1200px - 1920px
5. xl: >= 1920px

## 状态管理规范

### 数据流规范
1. 单向数据流：父组件 -> 子组件
2. 事件流：子组件 -> 父组件
3. 全局状态通过 props 和 events 传递

### 状态同步规范
1. 页面加载时获取最新数据
2. 操作完成后立即更新界面
3. 异常情况下保持状态一致性

### 加载状态规范
1. 异步操作期间显示加载状态
2. 使用 `loading` 属性控制加载状态
3. 提供取消操作选项（如适用）

## 错误处理规范

### 前端错误处理

#### 异步操作错误处理
```typescript
try {
  await someAsyncOperation()
  ElMessage.success('操作成功')
} catch (error) {
  ElMessage.error(`操作失败: ${(error as Error).message}`)
}
```

#### 表单验证错误处理
1. 必填字段验证
2. 格式验证
3. 提供明确的错误提示

#### 网络错误处理
1. 超时处理
2. 连接失败处理
3. 提供重试机制

### 后端错误处理

#### 参数验证
1. 必填参数检查
2. 参数格式验证
3. 返回明确错误信息

#### 业务逻辑错误
1. 状态检查
2. 权限验证
3. 返回用户友好的错误信息

#### 系统错误处理
1. 日志记录
2. 异常捕获
3. 优雅降级

## 测试规范

### 单元测试要求

#### 前端组件测试
1. 测试组件渲染
2. 测试用户交互
3. 测试数据流
4. 测试错误处理

#### 后端接口测试
1. 测试正常流程
2. 测试异常流程
3. 测试边界条件
4. 测试数据一致性

### 集成测试要求

#### 功能测试
1. 页面加载测试
2. 表单提交测试
3. 数据展示测试
4. 状态变更测试

#### 性能测试
1. 页面加载性能
2. 接口响应时间
3. 内存使用情况

## 安全规范

### 数据安全
1. 敏感信息（如API密钥）不应在前端日志中输出
2. 数据传输应考虑加密
3. 用户输入应进行过滤和验证

### 权限安全
1. 操作权限验证
2. 数据访问控制
3. 防止越权操作

### 网络安全
1. HTTPS 通信
2. 防止 XSS 攻击
3. 防止 CSRF 攻击

## 性能优化规范

### 前端性能优化

#### 组件优化
1. 合理使用 v-if 和 v-show
2. 避免不必要的重新渲染
3. 使用计算属性缓存复杂计算

#### 网络优化
1. 合理使用缓存
2. 减少不必要的网络请求
3. 使用防抖和节流

#### 打包优化
1. 代码分割
2. 懒加载
3. Tree shaking

### 后端性能优化

#### 数据库优化
1. 合理使用索引
2. 避免 N+1 查询
3. 批量操作

#### 接口优化
1. 合理设计 API
2. 使用缓存机制
3. 异步处理耗时操作

## 代码审查规范

### 审查要点

#### 功能完整性
1. 是否实现所有需求功能
2. 边界条件是否处理
3. 异常情况是否考虑

#### 代码质量
1. 是否符合编码规范
2. 是否有重复代码
3. 是否易于维护

#### 安全性
1. 是否有安全漏洞
2. 是否暴露敏感信息
3. 是否有权限控制

#### 性能
1. 是否有性能问题
2. 是否合理使用资源
3. 是否有内存泄漏

### 审查流程
1. 开发者自测
2. 提交代码审查
3. 审查意见反馈
4. 修改后重新审查
5. 合并到主分支

## 文档规范

### 代码注释规范
1. 导出函数必须有注释
2. 复杂逻辑必须有注释
3. 接口定义必须有注释
4. 组件方法应有功能说明

### 接口文档规范
1. 详细描述接口功能
2. 列出所有参数和返回值
3. 提供使用示例

### 用户文档规范
1. 功能说明清晰
2. 操作步骤详细
3. 配图说明（如需要）

## 国际化规范

### 文本处理
1. 界面文本应支持国际化
2. 错误消息应支持国际化
3. 使用统一的翻译管理

### 日期时间格式
1. 使用标准的日期时间格式
2. 支持本地化显示
3. 时区处理正确

## 可访问性规范

### 键盘导航
1. 支持 Tab 键在各控件间切换
2. 支持 Enter 键触发按钮和链接
3. 支持 Escape 键关闭对话框和抽屉

### 屏幕阅读器支持
1. 为所有交互元素提供适当的文字标签
2. 为状态变化提供适当的通知
3. 保持逻辑阅读顺序

### 高对比度模式
1. 确保文本与背景有足够的对比度
2. 确保所有控件在高对比度模式下可用