# 开发规范

## 代码规范

### Go 代码规范

1. **命名规范**
   - 使用驼峰命名法（CamelCase）
   - 公开函数和结构体首字母大写
   - 私有函数和结构体首字母小写
   - 变量和函数名应具有描述性

2. **注释规范**
   - 公开函数和结构体必须有注释说明
   - 注释应描述函数用途、参数含义和返回值
   - 复杂逻辑应有行内注释说明

3. **错误处理**
   - 所有可能出错的函数必须返回 error
   - 错误处理应具体明确，避免忽略错误
   - 提供有意义的错误信息

4. **代码结构**
   - 每个文件应有清晰的职责
   - 避免过长的函数，适当拆分
   - 合理使用接口抽象

### Vue/TypeScript 代码规范

1. **组件设计**
   - 使用单文件组件（SFC）
   - 组件名使用大写字母开头
   - 组件应具有单一职责

2. **状态管理**
   - 使用 Composition API 管理组件状态
   - 合理使用响应式数据
   - 避免在模板中使用复杂表达式

3. **命名规范**
   - 组件名使用 PascalCase
   - 变量和函数使用 camelCase
   - 常量使用 UPPER_CASE

4. **注释规范**
   - 复杂逻辑应有注释说明
   - 组件和函数应有功能描述
   - 接口和类型定义应有详细注释

## API 设计规范

### 接口命名

1. **统一风格**
   - 使用动词开头描述操作（Get/List/Create/Update/Delete）
   - 名称应清晰表达接口功能
   - 遵循 RESTful 风格

2. **参数设计**
   - 参数名使用 snake_case（与后端保持一致）
   - 必要参数应有明确说明
   - 复杂参数应有结构体定义

### 数据结构

1. **字段命名**
   - 前后端字段名保持一致
   - 使用 JSON tag 明确指定序列化名称
   - 避免自动转换命名风格

2. **类型一致性**
   - 前后端使用相同的数据类型
   - 枚举类型应有明确的值定义
   - 时间格式统一使用 ISO8601 标准

## 错误处理规范

### 后端错误处理

1. **错误分类**
   - 网络错误：服务不可达、超时等
   - 业务错误：参数错误、状态错误等
   - 系统错误：存储错误、内存不足等

2. **错误信息**
   - 提供清晰的错误描述
   - 包含错误码便于识别
   - 避免暴露敏感信息

3. **错误传递**
   - 统一错误处理中间件
   - 错误信息格式标准化
   - 详细错误记录到日志

### 前端错误处理

1. **用户提示**
   - 提供友好的错误提示信息
   - 根据错误类型显示不同消息
   - 避免显示技术性错误详情

2. **状态管理**
   - 错误状态应能自动清除
   - 相同操作的错误应去重
   - 提供重试机制

## 测试规范

### 单元测试

1. **覆盖率要求**
   - 核心业务逻辑覆盖率应达到 80% 以上
   - API 接口测试应覆盖所有分支
   - 边界条件和异常情况应有测试

2. **测试结构**
   - 使用 table-driven 测试方式
   - 测试用例应具有描述性名称
   - 每个测试应独立运行

### 集成测试

1. **场景覆盖**
   - 覆盖主要业务流程
   - 包含正常流程和异常流程
   - 模拟网络异常等外部依赖问题

2. **数据准备**
   - 使用测试数据而非生产数据
   - 测试前后清理相关数据
   - 确保测试环境隔离

## 文档规范

### API 文档

1. **接口说明**
   - 详细描述接口功能
   - 列出所有参数及其含义
   - 提供请求和响应示例

2. **错误码说明**
   - 列出所有可能的错误码
   - 说明错误原因和处理建议
   - 提供错误示例

### 开发文档

1. **架构文档**
   - 描述系统整体架构
   - 说明各组件职责和关系
   - 提供架构图示

2. **功能文档**
   - 按功能模块分别说明
   - 描述功能使用方法
   - 提供界面截图和操作说明

## Git 提交规范

### 提交信息格式

```
<type>(<scope>): <subject>

<body>

<footer>
```

### 提交类型

1. **feat**：新增功能
2. **fix**：修复 bug
3. **docs**：文档更新
4. **style**：代码格式调整
5. **refactor**：代码重构
6. **test**：测试相关
7. **chore**：构建过程或辅助工具的变动

### 提交要求

1. **原子性提交**
   - 每次提交只做一件事
   - 避免混合多种类型的更改
   - 提交信息应准确描述变更内容

2. **及时提交**
   - 完成功能及时提交
   - 避免积累大量未提交更改
   - 每个功能点完成后应有对应提交

## 代码审查规范

### 审查要点

1. **功能正确性**
   - 代码是否实现预期功能
   - 是否有遗漏的边界条件
   - 异常处理是否完善

2. **代码质量**
   - 是否符合编码规范
   - 代码是否易于理解和维护
   - 是否有重复代码

3. **安全性**
   - 是否有安全漏洞
   - 是否暴露敏感信息
   - 输入验证是否充分

### 审查流程

1. **提交前自检**
   - 运行所有测试确保通过
   - 检查代码规范符合性
   - 确认提交信息准确

2. **代码审查**
   - 至少一人审查后方可合并
   - 审查意见应及时回复和修改
   - 重大变更需多人审查

## 构建和部署规范

### 构建流程

1. **环境准备**
   - 确保构建环境一致性
   - 使用 Docker 容器化构建
   - 版本依赖应明确指定

2. **构建脚本**
   - 构建脚本应可重复执行
   - 构建过程应有详细日志
   - 构建产物应有版本标识

### 部署流程

1. **部署前检查**
   - 验证构建产物完整性
   - 检查配置文件正确性
   - 确认依赖服务可用

2. **部署执行**
   - 部署过程应可回滚
   - 部署后应有验证步骤
   - 部署日志应详细记录